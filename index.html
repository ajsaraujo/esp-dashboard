<!DOCTYPE html> 
<html>
	<head>
	</head>
	<script>	
		async function toggleLed(value) {
			let url = `led=${value}`; 
			let response = await fetch(url);
			console.log(`Led State = ${value}`); 
		}
		
		async function poll() {
			let response = await fetch('/poll'); 
			
			if (response.status == 502) {
				console.log('Timeout de conex√£o... :('); 
				await poll(); 
			} else if (response.status != 200) {
				console.log('Alguma coisa deu errado... -_-'); 
				console.log(response.statustext); 
			} else {
				let message = await response.text(); 
				console.log('Recebi:'); 
				console.log(message); 
				await poll(); 
			}
		}
	</script>
	<body>
		<h1>D1 Wemos Mini Dashboard</h1>
		<h2>Led State = OFF</h2>
		<button onclick="toggleLed('on')">Ligar</button>
		<button onclick="toggleLed('off')">Desligar</button>
	</body>
</html>